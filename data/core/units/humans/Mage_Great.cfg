#textdomain wesnoth-units
[unit_type]
    id=Great Mage
    name= _ "Great Mage"
    race=human
    gender=male,female
    image="units/human-magi/great-mage.png"
    profile="portraits/humans/mage-arch.webp"
    hitpoints=65
    movement_type=smallfoot
    movement=5
    experience=200
    level=4
    alignment=neutral
    advances_to=null
    {AMLA_DEFAULT}
    cost=110
    usage=mixed fighter
    description= _ "Any person who is even considered for the title of Great Mage is quite nearly a legend in their own time, and town criers have forcibly learnt discretion in applying the title. Merit for the title is carefully considered by a council of the leading magi of the age, and the conferment of the title is given only by a majority vote. Regardless, anyone who is seriously nominated for the honor of being called a Great Mage is, without question, a master of their art, and has surpassed almost any of their peers in skill.

Though they are not warriors, by any means, the application of their art to combat is something that often causes other soldiers to stand aside in awe."
    [special_note]
        note= _ "Compared to other mages, Great Mages have a higher resistance to ‘fire’ attacks."
    [/special_note]
    die_sound={SOUND_LIST:HUMAN_OLD_DIE}
    {DEFENSE_ANIM "units/human-magi/great-mage-defend.png" "units/human-magi/great-mage.png" {SOUND_LIST:HUMAN_OLD_HIT} }
    [resistance]
        fire=70
    [/resistance]
    [attack]
        name=staff
        description=_"staff"
        icon=attacks/staff-magic.png
        type=impact
        range=melee
        damage=9
        number=2
    [/attack]
    [attack]
        name=fireball
        description=_"fireball"
        type=fire
        range=ranged
        [specials]
            {WEAPON_SPECIAL_MAGICAL}
        [/specials]
        damage=17
        number=4
    [/attack]
    [attack_anim]
        [filter_attack]
            name=staff
        [/filter_attack]
        start_time=-250
        [frame]
            image="units/human-magi/great-mage.png:50"
        [/frame]
        [frame]
            image="units/human-magi/great-mage-attack-staff-[1~2].png:[100,200]"
        [/frame]
        {SOUND:HIT_AND_MISS staff.ogg staff-miss.ogg -125}
        [frame]
            image="units/human-magi/great-mage-attack-magic-1.png:75"
        [/frame]
        [frame]
            image="units/human-magi/great-mage.png:75"
        [/frame]
    [/attack_anim]

#define GREAT_MAGE_FIREBALL_ANIMS FEMALE
    # credit to Asmodeus for these animations
    # in n-nw-ne versions, the fireballs come from higher. In n/s they are angled differently and their target is different
    [attack_anim]
        [filter_attack]
            name=fireball
        [/filter_attack]
        direction=se,sw
        start_time=-800
        offset=0
        meteor1_start_time=-700
        meteor2_start_time=-600
        meteor3_start_time=-500
        [if]
            hits=yes
            [meteor1_frame]
                image="projectiles/fireball-nw.png~ROTATE(90)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(95)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(100)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                y=-300~-250,-250~-150,-150~-20
                directional_x=-72~16
            [/meteor1_frame]
            [meteor1_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=0
                halo_x=-20
                auto_vflip=no
            [/meteor1_frame]
            [meteor2_frame]
                image="projectiles/fireball-nw.png~ROTATE(90)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(95)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(100)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                y=-300~-250,-250~-150,-150~-5
                directional_x=-72~36
            [/meteor2_frame]
            [meteor2_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=15
                halo_x=0
                auto_vflip=no
            [/meteor2_frame]
            [meteor3_frame]
                image="projectiles/fireball-nw.png~ROTATE(90)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(95)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(100)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                y=-300~-250,-250~-150,-150~10
                directional_x=-72~56
            [/meteor3_frame]
            [meteor3_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=30
                halo_x=20
                auto_vflip=no
            [/meteor3_frame]
            attack_sound_start_time=-400
            [attack_sound_frame]
                sound=fire.wav
            [/attack_sound_frame]
        [/if]
        [else]
            hits=no
            [meteor1_frame]
                image="projectiles/fireball-nw.png~ROTATE(90)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(95)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(100)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                y=-300~-250,-250~-150,-150~-20
                directional_x=-72~16
            [/meteor1_frame]
            [meteor1_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=0
                halo_x=-20
                auto_vflip=no
            [/meteor1_frame]
            [meteor2_frame]
                image="projectiles/fireball-nw.png~ROTATE(90)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(95)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(100)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                y=-300~-250,-250~-180,-180~-40
                directional_x=-72~51
            [/meteor2_frame]
            [meteor2_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=-20
                halo_x=15
                auto_vflip=no
            [/meteor2_frame]
            [meteor3_frame]
                image="projectiles/fireball-nw.png~ROTATE(90)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(95)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(100)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                y=-300~-250,-250~-150,-150~80
                directional_x=-72~56
            [/meteor3_frame]
            [meteor3_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=60
                halo_x=20
                auto_vflip=no
            [/meteor3_frame]
            attack_sound_start_time=-400
            [attack_sound_frame]
                sound=fire.wav
            [/attack_sound_frame]
        [/else]
        [frame]
            image="units/human-magi/great-mage{FEMALE}.png:50"
        [/frame]
        [frame]
            image="units/human-magi/great-mage{FEMALE}-attack-magic-[1,2,1].png:[100,800,100]"
        [/frame]
        [frame]
            image="units/human-magi/great-mage{FEMALE}.png:50"
        [/frame]
    [/attack_anim]

    [attack_anim]
        [filter_attack]
            name=fireball
        [/filter_attack]
        direction=s
        start_time=-800
        offset=0
        meteor1_start_time=-700
        meteor2_start_time=-600
        meteor3_start_time=-500
        [if]
            hits=yes
            [meteor1_frame]
                halo="projectiles/fireball-nw.png~ROTATE(100)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(105)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(110)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                halo_y=-300~-250,-250~-150,-150~78
                halo_x=-108~-20
            [/meteor1_frame]
            [meteor1_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=0
                halo_x=-20
                auto_vflip=no
            [/meteor1_frame]
            [meteor2_frame]
                halo="projectiles/fireball-nw.png~ROTATE(100)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(105)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(110)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                halo_y=-300~-250,-250~-150,-150~93
                halo_x=-108~0
            [/meteor2_frame]
            [meteor2_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=15
                halo_x=0
                auto_vflip=no
            [/meteor2_frame]
            [meteor3_frame]
                halo="projectiles/fireball-nw.png~ROTATE(100)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(105)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(110)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                halo_y=-300~-250,-250~-150,-150~108
                halo_x=-108~20
            [/meteor3_frame]
            [meteor3_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=30
                halo_x=20
                auto_vflip=no
            [/meteor3_frame]
            attack_sound_start_time=-400
            [attack_sound_frame]
                sound=fire.wav
            [/attack_sound_frame]
        [/if]
        [else]
            hits=no
            [meteor1_frame]
                halo="projectiles/fireball-nw.png~ROTATE(100)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(105)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(110)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                halo_y=-300~-250,-250~-150,-150~16
                halo_x=-72~-20
            [/meteor1_frame]
            [meteor1_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=0
                halo_x=-20
                auto_vflip=no
            [/meteor1_frame]
            [meteor2_frame]
                halo="projectiles/fireball-nw.png~ROTATE(100)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(105)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(110)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                halo_y=-300~-250,-250~-150,-150~-4
                halo_x=-72~15
            [/meteor2_frame]
            [meteor2_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=-20
                halo_x=15
                auto_vflip=no
            [/meteor2_frame]
            [meteor3_frame]
                halo="projectiles/fireball-nw.png~ROTATE(100)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(105)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(110)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                halo_y=-300~-250,-250~-150,-150~116
                halo_x=-72~20
            [/meteor3_frame]
            [meteor3_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=60
                halo_x=20
                auto_vflip=no
            [/meteor3_frame]
            attack_sound_start_time=-400
            [attack_sound_frame]
                sound=fire.wav
            [/attack_sound_frame]
        [/else]
        [frame]
            image="units/human-magi/great-mage{FEMALE}.png:50"
        [/frame]
        [frame]
            image="units/human-magi/great-mage{FEMALE}-attack-magic-[1,2,1].png:[100,800,100]"
        [/frame]
        [frame]
            image="units/human-magi/great-mage{FEMALE}.png:50"
        [/frame]
    [/attack_anim]

    [attack_anim]
        [filter_attack]
            name=fireball
        [/filter_attack]
        direction=n
        start_time=-800
        offset=0
        meteor1_start_time=-700
        meteor2_start_time=-600
        meteor3_start_time=-500
        [if]
            hits=yes
            [meteor1_frame]
                halo="projectiles/fireball-nw.png~ROTATE(100)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(105)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(110)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                halo_y=-400~-350,-350~-250,-250~-66
                halo_x=-108~-20
            [/meteor1_frame]
            [meteor1_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=0
                halo_x=-20
                auto_vflip=no
            [/meteor1_frame]
            [meteor2_frame]
                halo="projectiles/fireball-nw.png~ROTATE(100)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(105)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(110)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                halo_y=-400~-350,-350~-250,-250~-51
                halo_x=-108~0
            [/meteor2_frame]
            [meteor2_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=15
                halo_x=0
                auto_vflip=no
            [/meteor2_frame]
            [meteor3_frame]
                halo="projectiles/fireball-nw.png~ROTATE(100)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(105)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(110)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                halo_y=-400~-350,-350~-250,-250~-36
                halo_x=-108~20
            [/meteor3_frame]
            [meteor3_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=30
                halo_x=20
                auto_vflip=no
            [/meteor3_frame]
            attack_sound_start_time=-400
            [attack_sound_frame]
                sound=fire.wav
            [/attack_sound_frame]
        [/if]
        [else]
            hits=no
            [meteor1_frame]
                halo="projectiles/fireball-nw.png~ROTATE(100)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(105)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(110)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                halo_y=-400~-350,-350~-250,-250~-128
                halo_x=-72~-20
            [/meteor1_frame]
            [meteor1_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=0
                halo_x=-20
                auto_vflip=no
            [/meteor1_frame]
            [meteor2_frame]
                halo="projectiles/fireball-nw.png~ROTATE(100)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(105)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(110)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                halo_y=-400~-350,-350~-250,-250~-148
                halo_x=-72~15
            [/meteor2_frame]
            [meteor2_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=-20
                halo_x=15
                auto_vflip=no
            [/meteor2_frame]
            [meteor3_frame]
                halo="projectiles/fireball-nw.png~ROTATE(100)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(105)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(110)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                halo_y=-400~-350,-350~-250,-250~-28
                halo_x=-72~20
            [/meteor3_frame]
            [meteor3_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=60
                halo_x=20
                auto_vflip=no
            [/meteor3_frame]
            attack_sound_start_time=-400
            [attack_sound_frame]
                sound=fire.wav
            [/attack_sound_frame]
        [/else]
        [frame]
            image="units/human-magi/great-mage{FEMALE}.png:50"
        [/frame]
        [frame]
            image="units/human-magi/great-mage{FEMALE}-attack-magic-[1,2,1].png:[100,800,100]"
        [/frame]
        [frame]
            image="units/human-magi/great-mage{FEMALE}.png:50"
        [/frame]
    [/attack_anim]

    [attack_anim]
        [filter_attack]
            name=fireball
        [/filter_attack]
        direction=ne,nw
        start_time=-800
        offset=0
        meteor1_start_time=-700
        meteor2_start_time=-600
        meteor3_start_time=-500
        [if]
            hits=yes
            [meteor1_frame]
                image="projectiles/fireball-nw.png~ROTATE(90)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(95)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(100)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                y=-400~-350,-350~-250,-250~-92
                directional_x=-72~16
            [/meteor1_frame]
            [meteor1_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=0
                halo_x=-20
                auto_vflip=no
            [/meteor1_frame]
            [meteor2_frame]
                image="projectiles/fireball-nw.png~ROTATE(90)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(95)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(100)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                y=-400~-350,-350~-250,-250~-77
                directional_x=-72~36
            [/meteor2_frame]
            [meteor2_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=15
                halo_x=0
                auto_vflip=no
            [/meteor2_frame]
            [meteor3_frame]
                image="projectiles/fireball-nw.png~ROTATE(90)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(95)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(100)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                y=-400~-350,-350~-250,-250~-62
                directional_x=-72~56
            [/meteor3_frame]
            [meteor3_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=30
                halo_x=20
                auto_vflip=no
            [/meteor3_frame]
            attack_sound_start_time=-400
            [attack_sound_frame]
                sound=fire.wav
            [/attack_sound_frame]
        [/if]
        [else]
            hits=no
            [meteor1_frame]
                image="projectiles/fireball-nw.png~ROTATE(90)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(95)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(100)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                y=-400~-350,-350~-250,-250~-92
                directional_x=-72~16
            [/meteor1_frame]
            [meteor1_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=0
                halo_x=-20
                auto_vflip=no
            [/meteor1_frame]
            [meteor2_frame]
                image="projectiles/fireball-nw.png~ROTATE(90)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(95)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(100)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                y=-400~-350,-350~-250,-250~-112
                directional_x=-72~51
            [/meteor2_frame]
            [meteor2_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=-20
                halo_x=15
                auto_vflip=no
            [/meteor2_frame]
            [meteor3_frame]
                image="projectiles/fireball-nw.png~ROTATE(90)~O(60%)~SCALE(60,60):50,projectiles/fireball-nw.png~ROTATE(95)~O(80%)~SCALE(75,75):100,projectiles/fireball-nw.png~ROTATE(100)~SCALE(90,90):450"
                auto_hflip=yes
                auto_vflip=no
                y=-400~-350,-350~-250,-250~8
                directional_x=-72~56
            [/meteor3_frame]
            [meteor3_frame]
                halo="projectiles/fireball-impact-[1~16].png~SCALE(90,135):60"
                offset=1.0
                halo_y=60
                halo_x=20
                auto_vflip=no
            [/meteor3_frame]
            attack_sound_start_time=-400
            [attack_sound_frame]
                sound=fire.wav
            [/attack_sound_frame]
        [/else]
        [frame]
            image="units/human-magi/great-mage{FEMALE}.png:50"
        [/frame]
        [frame]
            image="units/human-magi/great-mage{FEMALE}-attack-magic-[1,2,1].png:[100,800,100]"
        [/frame]
        [frame]
            image="units/human-magi/great-mage{FEMALE}.png:250"
        [/frame]
    [/attack_anim]
#enddef
    {GREAT_MAGE_FIREBALL_ANIMS ()}

    [female]
        name= _ "female^Great Mage"
        gender=female
        image="units/human-magi/great-mage+female.png"
        profile="portraits/humans/mage-arch+female.webp"
        die_sound={SOUND_LIST:HUMAN_FEMALE_DIE}
        {DEFENSE_ANIM "units/human-magi/great-mage+female-defend.png" "units/human-magi/great-mage+female.png" {SOUND_LIST:HUMAN_FEMALE_HIT} }
        [attack_anim]
            [filter_attack]
                name=staff
            [/filter_attack]
            [frame]
                image="units/human-magi/great-mage+female.png:50"
            [/frame]
            [frame]
                image="units/human-magi/great-mage+female-attack-staff-[1~2].png:[100,200]"
            [/frame]
            [frame]
                image="units/human-magi/great-mage+female-attack-magic-1.png:75"
            [/frame]
            [frame]
                image="units/human-magi/great-mage+female.png:75"
            [/frame]
        [/attack_anim]
        {GREAT_MAGE_FIREBALL_ANIMS (+female)}
    [/female]
[/unit_type]
